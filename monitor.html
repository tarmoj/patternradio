<!DOCTYPE html>
<html>
  <head>
    <title>Pattern-radio monitor</title>
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <meta content="Tarmo Johannes" id="author">
    
    <style></style>
    
    <script src="ws-functions.js"></script>
    <script>
    
		function onMessage(evt)
		{
			writeToScreen("Message from server: " + evt.data + '\n');
			var mess_array = evt.data.split(",");
			console.log(mess_array[0]);
			var currentName = ["currentLow","currentMedium","currentHigh"];
			var names = ["lownames","mediumnames","highnames"];
			var steps = ["lowsteps", "mediumsteps", "highsteps"];
			var voice;
			if (mess_array[0] == "names") {	 // comes in as names,<voice number>, <names separated with \n
				voice = parseInt(mess_array[1]);
				console.log("voice",voice,"id:",names[voice],mess_array[2]);
				document.getElementById(names[voice]).innerHTML = mess_array[2];
				
			}
			if (mess_array[0] == "clear") {	 // comes in as names,<voice number>, <names separated with \n
				voice = parseInt(mess_array[1]);
				document.getElementById(names[voice]).innerHTML=""; //TODO:
				document.getElementById(currentName[voice]).innerHTML = "Nobody";
				document.getElementById(steps[voice]).innerHTML = "";
			}
			if (mess_array[0].indexOf("pattern")===0) {
				voice = parseInt(mess_array[2]);
				var name = mess_array[1];
				//console.log("Name: ", name)
				document.getElementById(currentName[voice]).innerHTML = name;
				var stepString = mess_array.slice(mess_array.indexOf("steps:")+1);
				document.getElementById(steps[voice]).innerHTML = stepString;
				// TODO: function setSteps(voice, stepsArray) ;
				
				//var speaker = mess_array[5];
				//patternRects.itemAt(voice).speaker = parseInt(speaker);
			}
		}
    
		
    
		function openAction() {
			console.log("sending monitor");
			doSend("monitor");
		};
		
		window.onload = function() {
			doConnect();
		};
	
		
	
    </script>
    
    
    
  </head>
  <body style="max-width:600px">
  <h1>Pattern-radio monitor</h1>
  <br>
  (Explanation.)  Here you can listen to music created by various people.... bla <br><br><br>
  Listen the radio here <audio controls src="http://johannes.homeip.net:8000/radio"></audio><br><br>
  Or open  	
 <a href=http://johannes.homeip.net:8000/radio target="_blank">this link</a> <br>
  <br>
  <form name="myform">
  <br>
  Heart-rate: <span id="heatrate">?</span>
  <br><br>
  Info about playing voices:<br>
   <table border="1" style="width:90%">
  <tr>
    <td>Low</td>
    <td>Medium</td>
    <td>High</td>
  </tr>
  <tr>
    <td>
    Currently playing: <span id="currentLow">Nobody</span><br>
	Steps: <span id="lowsteps"></span><br>
	Names in queue:<br>
	<textarea id="lownames" rows="8" readonly></textarea><br><br>
    
    </td>
    <td>
    Currently playing: <span id="currentMedium">Nobody</span><br>
	Steps: <span id="mediumsteps"></span><br>
	Names in queue:<br>
	<textarea id="mediumnames" rows="8" readonly></textarea><br><br>
    </td>
    <td>
    Currently playing: <span id="currentHigh">Nobody</span><br>
	Steps: <span id="highsteps"></span><br>
	Names in queue:<br>
	<textarea id="highnames" rows="8" readonly></textarea><br><br>
    </td>
  </tr>
</table> 
  
  
  
  Server address: <input value="ws://johannes.homeip.net:10010/ws" id="url" type="text"><br>
    <button type="button" id="connectButton" onclick="doConnect();">Connect</button>
    <br>
    <br>
    <p><textarea id="outputtext" rows="5" cols="30" readonly></textarea> </p>
  </form>
  
  
  
  </body>
</html>
<!DOCTYPE html>
<html>
  <head>
    <title>Pattern-radio monitor</title>
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <meta content="Tarmo Johannes" id="author">
    
    <style></style>
    
    <script src="ws-functions.js"></script>
    <script>
    
		function onMessage(evt)
		{
			writeToScreen("Message from server: " + evt.data + '\n');
			var mess_array = evt.data.split(",");
			console.log(mess_array[0]);
			var currentName = ["currentLow","currentMedium","currentHigh"];
			var names = ["lownames","mediumnames","highnames"];
			var steps = ["lowsteps", "mediumsteps", "highsteps"];
			var voice;
			if (mess_array[0] == "names") {	 // comes in as names,<voice number>, <names separated with \n
				voice = parseInt(mess_array[1]);
				console.log("voice",voice,"id:",names[voice],mess_array[2]);
				document.getElementById("lownames").innterHTML = mess_array[2]; 
				
			}
			if (mess_array[0] == "clear") {	 // comes in as names,<voice number>, <names separated with \n
				voice = parseInt(mess_array[1]);
				document.getElementById(names[voice]).innerHTML=""; //TODO:
				document.getElementById(currentName[voice]).innerHTML = "Nobody";
			}
			if (mess_array[0]==="pattern") {
				voice = parseInt(mess_array[2]);
				var name = mess_array[1];
				//console.log("Name: ", name)
				document.getElementById(currentName[voice]).innerHTML = name;
				var stepString = mess_array.slice(mess_array.indexOf("steps:")+1);
				document.getElementById(steps[voice]).innerHTML = stepString;
				// TODO: function setSteps(voice, stepsArray) ;
				
				//var speaker = mess_array[5];
				//patternRects.itemAt(voice).speaker = parseInt(speaker);
			}
		}
    
		
    
		function openAction() {
			console.log("sending monitor");
			doSend("monitor");
		};
		
		window.onload = function() {
			doConnect();
		};
	
		
	
    </script>
    
    
    
  </head>
  <body>
  <h1>Pattern-radio monitor</h1>
  <br>
  (Explanation.)  Here you can listen to music created by various people.... bla <br>
  Listen the radio: --- <br>
  <br>
  <form name="myform">
  Clients: <span id="clientsCount"></span><br>
  Heart-rate: <span id="heatrate">?</span>
  <br><br>
  Low:<br>
  Currently playing: <span id="currentLow">Nobody</span><br>
  Steps: <span id="lowsteps"></span><br>
  Names in queue:<br>
  <textarea id="lownames" rows="8" readonly></textarea><br>
  
  
  Server address: <input value="ws://localhost:10010/ws" id="url" type="text"><br>
    <button type="button" id="connectButton" onclick="doConnect();">Connect</button>
    <br>
    <br>
    <p><textarea id="outputtext" rows="5" cols="30" readonly></textarea> </p>
  </form>
  
  
  
  </body>
</html>